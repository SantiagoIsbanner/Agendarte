<div class="panel-container">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <div class="hero-icon">ğŸ©º</div>
      <h1>Panel Profesional</h1>
      <p>Gestiona tu agenda mÃ©dica de forma inteligente</p>
    </div>
    <div class="hero-stats">
      <div class="stat-item">
        <span class="stat-number">{{ getTodayEvents() }}</span>
        <span class="stat-label">Citas Hoy</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">{{ isAuthenticated() ? 'âœ“' : 'âœ—' }}</span>
        <span class="stat-label">Google Sync</span>
      </div>
    </div>
  </div>

  <!-- Action Bar -->
  <div class="action-bar">
    <div class="action-group">
      <button class="btn-modern primary" (click)="showNewAppointmentModal()">
        <span class="btn-icon">â•</span>
        <span>Nueva Cita</span>
      </button>
      <button class="btn-modern secondary" (click)="loadCalendar()" [disabled]="!isAuthenticated()">
        <span class="btn-icon">ğŸ”„</span>
        <span>Sincronizar</span>
      </button>
    </div>
    
    <div class="connection-status">
      @if (isAuthenticated()) {
        <div class="status-badge connected">
          <span class="status-dot"></span>
          <span>Google Calendar Conectado</span>
        </div>
      } @else {
        <button class="btn-modern google" (click)="authenticate()" [disabled]="isConnecting()">
          @if (isConnecting()) {
            <span class="btn-icon spinning">âŸ³</span>
            <span>Conectando...</span>
          } @else {
            <span class="btn-icon">ğŸ”—</span>
            <span>Conectar Google</span>
          }
        </button>
      }
    </div>
  </div>

  <!-- Calendar Section -->
  <div class="calendar-section">
    <div class="section-header">
      <h2>ğŸ“… Calendario de Citas</h2>
      <div class="calendar-controls">
        <button class="control-btn active">Mes</button>
        <button class="control-btn">Semana</button>
        <button class="control-btn">DÃ­a</button>
      </div>
    </div>
    <div class="calendar-wrapper">
      <div id="calendar"></div>
    </div>
  </div>

  <!-- Modal para nuevo turno -->
  @if (showModal()) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>â• Asignar Nuevo Turno</h3>
          <button class="close-btn" (click)="closeModal()">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Paciente: *</label>
            <input type="text" [(ngModel)]="newAppointment.patient" placeholder="Nombre del paciente" required>
          </div>
          <div class="form-group">
            <label>Email del paciente: *</label>
            <input type="email" [(ngModel)]="newAppointment.email" placeholder="email@ejemplo.com" required>
          </div>
          <div class="form-group">
            <label>Fecha: *</label>
            <input type="date" [(ngModel)]="newAppointment.date" required>
          </div>
          <div class="form-group">
            <label>Hora: *</label>
            <input type="time" [(ngModel)]="newAppointment.time" required>
          </div>
          <div class="form-group">
            <label>DuraciÃ³n:</label>
            <select [(ngModel)]="newAppointment.duration">
              <option value="30">30 minutos</option>
              <option value="60">1 hora</option>
              <option value="90">1.5 horas</option>
            </select>
          </div>
          <div class="form-group">
            <label>Notas:</label>
            <textarea [(ngModel)]="newAppointment.notes" placeholder="Notas adicionales"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn" (click)="closeModal()">Cancelar</button>
          <button class="btn success" (click)="saveAppointment()">ğŸ’¾ Guardar Turno</button>
        </div>
      </div>
    </div>
  }

  <!-- Modal para detalles del evento -->
  @if (showEventModal()) {
    <div class="modal-overlay" (click)="closeEventModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>ğŸ“… Detalles de la Cita</h3>
          <button class="close-btn" (click)="closeEventModal()">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="event-details">
            <div class="detail-item">
              <strong>Paciente:</strong>
              <span>{{ selectedEvent()?.title?.replace('Consulta - ', '') }}</span>
            </div>
            <div class="detail-item">
              <strong>Fecha:</strong>
              <span>{{ formatDate(selectedEvent()?.start) }}</span>
            </div>
            <div class="detail-item">
              <strong>Hora:</strong>
              <span>{{ formatTime(selectedEvent()?.start) }} - {{ formatTime(selectedEvent()?.end) }}</span>
            </div>
            <div class="detail-item">
              <strong>Email:</strong>
              <span>{{ selectedEvent()?.extendedProps?.email || 'No especificado' }}</span>
            </div>
            <div class="detail-item">
              <strong>Notas:</strong>
              <span>{{ selectedEvent()?.extendedProps?.notes || 'Sin notas' }}</span>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn danger" (click)="deleteEvent()">ğŸ—‘ï¸ Eliminar</button>
          <button class="btn" (click)="editEvent()">âœï¸ Modificar</button>
          <button class="btn" (click)="closeEventModal()">Cerrar</button>
        </div>
      </div>
    </div>
  }
</div>